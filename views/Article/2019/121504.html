<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>闭包原理 | DA-HUA个人博客</title>
    <meta name="description" content="A smile is a curve that sets everything straight">
    <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.9c66f740.css" as="style"><link rel="preload" href="/assets/js/app.499696ae.js" as="script"><link rel="preload" href="/assets/js/4.f284e26c.js" as="script"><link rel="preload" href="/assets/js/1.1239ed58.js" as="script"><link rel="preload" href="/assets/js/20.4395438e.js" as="script"><link rel="prefetch" href="/assets/js/10.96de110a.js"><link rel="prefetch" href="/assets/js/11.13cbc0f3.js"><link rel="prefetch" href="/assets/js/12.440a79e4.js"><link rel="prefetch" href="/assets/js/13.b01b2ef4.js"><link rel="prefetch" href="/assets/js/14.7fe83f69.js"><link rel="prefetch" href="/assets/js/15.9e407c24.js"><link rel="prefetch" href="/assets/js/16.4c10260f.js"><link rel="prefetch" href="/assets/js/17.865867a5.js"><link rel="prefetch" href="/assets/js/18.152e76ff.js"><link rel="prefetch" href="/assets/js/19.a76adc7b.js"><link rel="prefetch" href="/assets/js/21.78812a77.js"><link rel="prefetch" href="/assets/js/22.37faa5f6.js"><link rel="prefetch" href="/assets/js/23.4a2aa919.js"><link rel="prefetch" href="/assets/js/24.84193661.js"><link rel="prefetch" href="/assets/js/25.e414d943.js"><link rel="prefetch" href="/assets/js/26.7f084407.js"><link rel="prefetch" href="/assets/js/27.a342f05f.js"><link rel="prefetch" href="/assets/js/5.4654f2a4.js"><link rel="prefetch" href="/assets/js/6.c701cf4c.js"><link rel="prefetch" href="/assets/js/7.ec033919.js"><link rel="prefetch" href="/assets/js/8.1b14948d.js"><link rel="prefetch" href="/assets/js/9.6e4e65f2.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.1542df88.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9c66f740.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/head.png" alt="DA-HUA个人博客" class="logo"> <span class="site-name">DA-HUA个人博客</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      笔戮
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/前端.html" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/category/收集.html" class="nav-link"><i class="iconfont undefined"></i>
  收集
</a></li><li class="dropdown-item"><!----> <a href="/category/总结.html" class="nav-link"><i class="iconfont undefined"></i>
  总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读论.html" class="nav-link"><i class="iconfont undefined"></i>
  读论
</a></li><li class="dropdown-item"><!----> <a href="/category/ubuntu.html" class="nav-link"><i class="iconfont undefined"></i>
  ubuntu
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  择拣
</a></div><div class="nav-item"><a href="/Store/" class="nav-link"><i class="iconfont reco-date"></i>
  小计
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  求知
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      闻道
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dileigege" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/5dacc30649d9" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      笔戮
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/前端.html" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/category/收集.html" class="nav-link"><i class="iconfont undefined"></i>
  收集
</a></li><li class="dropdown-item"><!----> <a href="/category/总结.html" class="nav-link"><i class="iconfont undefined"></i>
  总结
</a></li><li class="dropdown-item"><!----> <a href="/category/读论.html" class="nav-link"><i class="iconfont undefined"></i>
  读论
</a></li><li class="dropdown-item"><!----> <a href="/category/ubuntu.html" class="nav-link"><i class="iconfont undefined"></i>
  ubuntu
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  择拣
</a></div><div class="nav-item"><a href="/Store/" class="nav-link"><i class="iconfont reco-date"></i>
  小计
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  求知
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      闻道
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dileigege" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/5dacc30649d9" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>闭包原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/views/Article/2019/121504.html#_0-1javascript变量" class="sidebar-link">0-1javascript变量</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/Article/2019/121504.html#_0-2javascript作用域" class="sidebar-link">0-2javascript作用域</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/Article/2019/121504.html#_0-3javascript作用域链" class="sidebar-link">0-3javascript作用域链</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/Article/2019/121504.html#_0-4javascript执行环境" class="sidebar-link">0-4javascript执行环境</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/Article/2019/121504.html#_0-5闭包" class="sidebar-link">0-5闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Article/2019/121504.html#_0-5-1什么是闭包" class="sidebar-link">0-5-1什么是闭包?</a></li><li class="sidebar-sub-header"><a href="/views/Article/2019/121504.html#_0-5-2闭包的作用" class="sidebar-link">0-5-2闭包的作用</a></li><li class="sidebar-sub-header"><a href="/views/Article/2019/121504.html#_0-5-3闭包的条件" class="sidebar-link">0-5-3闭包的条件</a></li><li class="sidebar-sub-header"><a href="/views/Article/2019/121504.html#_0-5-4闭包案例" class="sidebar-link">0-5-4闭包案例</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>闭包原理</h1> <hr> <div data-v-b53d65a4><i class="iconfont reco-account" data-v-b53d65a4><span data-v-b53d65a4>Allen</span></i> <i class="iconfont reco-date" data-v-b53d65a4><span data-v-b53d65a4>2019-2-15</span></i> <span id="/views/Article/2019/121504.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-2e99e05a data-v-b53d65a4><i class="iconfont reco-eye" style="margin-right: .5rem" data-v-2e99e05a></i> <a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;" data-v-2e99e05a></a></span> <i class="iconfont reco-tag tags" data-v-b53d65a4><span class="tag-item" data-v-b53d65a4>
      JavaScript
    </span></i></div></div> <div class="content__default"><div class="tip custom-block"><ul><li>变量</li> <li>作用域</li> <li>作用域链</li> <li>闭包</li></ul></div> <h2 id="_0-1javascript变量"><a href="#_0-1javascript变量" aria-hidden="true" class="header-anchor">#</a> 0-1javascript变量</h2> <p>1JavaScript 变量：<strong>JavaScript 变量是存储数据值的容器</strong>
声明（创建） JavaScript 变量：通过 -var- 关键词来声明 JavaScript 变量：</p> <h2 id="_0-2javascript作用域"><a href="#_0-2javascript作用域" aria-hidden="true" class="header-anchor">#</a> 0-2javascript作用域</h2> <p>2JS作用域大致分为三：全局作用域和局部作用域，以及ES6的块级作用域
<strong>全局作用域</strong>:最外层函数定义的变量拥有全局作用域，即对任何内部函数来说，都是可以访问的：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> outerVar <span class="token operator">=</span> <span class="token string">&quot;outer&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>outerVar<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//result:outer</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>局部作用域</strong>:和全局作用域相反，局部作用域一般只在固定的代码片段内可访问到，而对于函数外部是无法访问的，最常见的例如函数内部</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">var</span> innerVar <span class="token operator">=</span> <span class="token string">&quot;inner&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>innerVar<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//报错，是没有定义</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>值得一提的是如果你在函数内部没有用var定义函数，那你其实声明了一个全局的变量</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         innerVar <span class="token operator">=</span> <span class="token string">&quot;inner&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>innerVar<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// result:inner</span>
   </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>同样原理我们看如下代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;global&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//result:undefined</span>
         <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;local&quot;</span><span class="token punctuation">;</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//result:local;</span>
      <span class="token punctuation">}</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>不要怀疑，对就如你眼中看到一样，js和别的语言有区别，<strong>函数内定义了一个局部变量，函数在解析的时候都会将这个变量“提前声明”</strong>：</p> <h2 id="_0-3javascript作用域链"><a href="#_0-3javascript作用域链" aria-hidden="true" class="header-anchor">#</a> 0-3javascript作用域链</h2> <p>我对作用域链的理解是：
在内部函数可以访问外部函数变量的这种机制，用所梯度链式查找的方式，决定哪些数据能被内部函数访问的过程。 那我就想问，为啥内部可以访问外部？</p> <h2 id="_0-4javascript执行环境"><a href="#_0-4javascript执行环境" aria-hidden="true" class="header-anchor">#</a> 0-4javascript执行环境</h2> <p>所谓执行环境（有时也称环境）它是JavaScript中最为重要的一个概念。执行环境定义了变量或函数有权访问的其他数据 ，决定了它们各自的行为。<strong>js为每一个执行环境关联了一个变量对象。环境中定义的所有变量和函数都保存在这个对象中</strong>.
①比如：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;小美&quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">function</span> <span class="token function">got1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">return</span> name<span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">got2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">return</span> name<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">got1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">got2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>全局执行环境是最外围的执行环境，全局执行环境被认为是window对象，因此所有的全局变量和函数都作为window对象的属性和方法创建的。 js的执行顺序是根据函数的调用来决定的，当一个函数被调用时，该函数环境的变量对象就被压入一个环境栈中。而在函数执行之后，栈将该函数的变量对象弹出，把控制权交给之前的执行环境变量对象</strong>。</p> <p>当某个函数第一次被调用时，就会创建一个执行环境(execution context)以及相应的作用域链，并把作用域链赋值给一个特殊的内部属性([scope])。然后使用this，arguments(arguments在全局环境中不存在)和其他命名参数的值来初始化函数的活动对象(activation object)。当前执行环境的变量对象始终在作用域链的第0位。
因此我们可以看过程图：当got1()第一调用的时候，会创建一个由got1函数对象创建的执行环境，可以看到got1里并没有scope变量，于是沿着作用域链(scope chain)向后寻找，结果在全局变量对象里找到了scope，所以就返回全局变量对象里的scope值。执行过后，栈会将got1()对象“销毁”，然后执行同样步骤的got2（）</p> <blockquote><p>那这些又和闭包有什么关系那？</p></blockquote> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">function</span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;outer&quot;</span><span class="token punctuation">;</span>
         <span class="token keyword">function</span> <span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> scope<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">return</span> innto<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>以上其实就是一个闭包，而闭包的原理也就是图鉴的原理！我们分析代码：</strong></p> <div class="tip custom-block"><blockquote><p>outer()内部返回了一个into函数，</p></blockquote> <ul><li>①当调用out时，into函数的作用域链就已经被初始化了，（也就是说已经执行了图示的过程，在本作用域内没有，然后到父级类找）</li> <li>②一般来说，当某个环境中的所有代码执行完毕后，该环境被销毁（弹出环境栈），保存在其中的所有变量和函数也随之销毁（全局执行环境变量直到应用程序退出，如网页关闭才会被销毁） <strong>但是像上面那种有内部函数的又有所不同</strong>，</li> <li>③当out()函数执行结束，执行环境被销毁，但是其关联的活动对象并没有随之销毁，<strong>而是一直存在于内存中，因为该活动对象被其内部函数的作用域链所引用</strong></li></ul></div> <h2 id="_0-5闭包"><a href="#_0-5闭包" aria-hidden="true" class="header-anchor">#</a> 0-5闭包</h2> <h3 id="_0-5-1什么是闭包"><a href="#_0-5-1什么是闭包" aria-hidden="true" class="header-anchor">#</a> 0-5-1什么是闭包?</h3> <p>闭包：<strong>闭包（Closure）是JavaScript语言中一个非常重要的特性</strong></p> <ul><li>MDN：闭包是函数和声明该函数的词法环境的组合。</li> <li>在Javascript语言中，只有函数中的子函数才能引用函数中的变量，简单来说，闭包就是定义在函数中的函数，是函数内外部连接的桥梁</li> <li>闭包的意义是：当前作用域总是能够访问外部作用域中的变量；函数是唯一拥有自身作用域的结构，所以闭包的创建依赖于函数</li> <li>百度百科：闭包就是能够读取其他函数内部变量的函数。例如在javascript中，只有函数内部的子函数才能读取局部变量，所以闭包可以理解成“定义在一个函数内部的函数“。在本质上，闭包是将函数内部和函数外部连接起来的桥梁。</li></ul> <h3 id="_0-5-2闭包的作用"><a href="#_0-5-2闭包的作用" aria-hidden="true" class="header-anchor">#</a> 0-5-2闭包的作用</h3> <ul><li>读取自身函数外部的变量（沿着作用域链寻找）</li> <li>让这些外部变量始终保存在内存中</li> <li>延长局部变量的生命周期</li> <li>维护私有变量-局部变量的安全</li></ul> <h3 id="_0-5-3闭包的条件"><a href="#_0-5-3闭包的条件" aria-hidden="true" class="header-anchor">#</a> 0-5-3闭包的条件</h3> <div class="tip custom-block"><ul><li><ol><li>外层函数 和 子函数</li></ol></li> <li><ol start="2"><li>外层函数必须有局部变量</li></ol></li> <li><ol start="3"><li>子函数要操作外层函数的局部变量</li></ol></li> <li><ol start="4"><li>让子函数和外部产生关联。 // 关联不一定是返回函数</li></ol></li></ul></div> <h3 id="_0-5-4闭包案例"><a href="#_0-5-4闭包案例" aria-hidden="true" class="header-anchor">#</a> 0-5-4闭包案例</h3> <p>写个闭包：就用this，今天碰到的</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>　<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;The Window&quot;</span><span class="token punctuation">;</span>
　　<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
　　　　name <span class="token punctuation">:</span> <span class="token string">&quot;My Object&quot;</span><span class="token punctuation">,</span>
<span class="token function-variable function">　　　　getNameFunc</span> <span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
　　　　　　<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
　　　　　　　　<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
　　　　　　<span class="token punctuation">}</span><span class="token punctuation">;</span>
　　　　<span class="token punctuation">}</span>
　　<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">　　alert</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//result:The Window</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <!----> <footer class="page-edit"><!----> <!----></footer> <!----> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.499696ae.js" defer></script><script src="/assets/js/4.f284e26c.js" defer></script><script src="/assets/js/1.1239ed58.js" defer></script><script src="/assets/js/20.4395438e.js" defer></script>
  </body>
</html>
